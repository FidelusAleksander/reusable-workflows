name: CI

on:
  pull_request:
    branches:
      - main

permissions:
  contents: read

jobs:
  quality:
    name: Quality checks
    uses: ./.github/workflows/reusable-node-quality.yml
    with:
      node-version: "24"

  pages:
    needs: quality
    name: Deploy to GitHub Pages
    permissions:
      contents: read
      pages: write
      id-token: write
    uses: ./.github/workflows/deploy-pages.yml
    with:
      node-version: "24"

  comment:
    needs: [quality, pages]
    if: always()
    name: Comment on PR
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      - name: Comment with Pages URL
        uses: GrantBirki/comment@v2.1.1
        with:
          issue-number: ${{ github.event.pull_request.number }}
          body: |
            âœ… **Quality checks completed with status "${{ needs.quality.result }}"**

            **Workflow run:** https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}

            **GitHub Pages URL:** ${{ needs.pages.outputs.page_url }}



